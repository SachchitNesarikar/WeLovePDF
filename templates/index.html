<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WeLovePDF</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 30px;
      text-align: center;
    }
    h1 {
      color: #e53935;
      margin-bottom: 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      justify-items: center;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 20px;
      width: 100%;
      max-width: 350px;
      transition: transform 0.2s ease;
    }
    .card:hover { transform: translateY(-5px); }
    .card h2 {
      color: #d32f2f;
      margin-bottom: 10px;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
      text-align: left;
    }
    .row {
      display: flex;
      gap: 10px;
    }
    .half {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }
    input[type="file"],
    input[type="number"],
    input[type="text"] {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background: #d32f2f;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background: #b71c1c; }
    .add-btn {
      background: #555;
      margin-top: 5px;
    }
    .preview-list {
      font-size: 0.9em;
      color: #555;
      background: #fafafa;
      border-radius: 5px;
      padding: 5px;
      max-height: 100px;
      overflow-y: auto;
    }
    footer {
      margin-top: 40px;
      color: #777;
    }
  </style>
</head>
<body>
  <h1> WeLovePDF </h1>

<!-- FIRST ROW: CONVERSION TOOLS -->
<div class="grid">
  <!-- IMAGE TO PDF -->
  <div class="card">
    <h2>üñºÔ∏è Extract Images from PDF</h2>
    <form action="/extract_images" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <label>Output ZIP Name:</label>
      <input type="text" name="output_name" placeholder="ExtractedImages">
      <button type="submit">Extract Images</button>
    </form>
  </div>

  <div class="card">
    <h2>üñºÔ∏è Extract Images from PDF</h2>
    <form action="/extract_images" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <label>Output ZIP Name:</label>
      <input type="text" name="output_name" placeholder="ExtractedImages">
      <button type="submit">Extract Images</button>
    </form>
  </div>

  <div class="card">
    <h2>üìÑ Word ‚û°Ô∏è PDF</h2>
    <form action="/word_to_pdf" method="post" enctype="multipart/form-data">
      <label>Select Word File (.docx):</label>
      <input type="file" name="word_file" accept=".doc,.docx" required>
      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="ConvertedPDF">
      <button type="submit">Convert to PDF</button>
    </form>
  </div>

  <!-- PDF TO WORD -->
  <div class="card">
    <h2>üì§ PDF ‚û°Ô∏è Word</h2>
    <form action="/pdf_to_word" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="ConvertedWord">
      <button type="submit">Convert to Word</button>
    </form>
  </div>
</div>

<div class="grid" style="margin-top: 40px;">
  <!-- SPLIT PDF -->
  <div class="card">
    <h2>‚úÇÔ∏è Split PDF</h2>
    <form action="/split" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <div class="row">
        <div class="half">
          <label>Start Page:</label>
          <input type="number" name="start_page" required>
        </div>
        <div class="half">
          <label>End Page:</label>
          <input type="number" name="end_page" required>
        </div>
      </div>
      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="MySplitFile">
      <button type="submit">Split PDF</button>
    </form>
  </div>

  <!-- MERGE PDF -->
  <div class="card">
    <h2>üîó Merge PDFs</h2>
    <form id="mergeForm" action="/merge" method="post" enctype="multipart/form-data">
      <label>Select PDF Files:</label>
      <input type="file" id="mergeInput" name="pdf_files" accept="application/pdf" multiple required>
      <button type="button" class="add-btn" id="addMergeBtn">+ Add More PDFs</button>
      <div class="preview-list" id="mergePreviewList">No PDFs added yet</div>
      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="MyMergedFile">
      <button type="submit">Merge PDFs</button>
    </form>
  </div>

  <!-- DELETE PDF PAGES -->
  <div class="card">
    <h2>üóëÔ∏è Delete PDF Pages</h2>
    <form action="/delete_pages" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <div class="row">
        <div class="half">
          <label>Pages to Delete:</label>
          <input type="text" name="pages_to_delete" placeholder="1,3,5">
        </div>
        <div class="half">
          <label>Output File Name:</label>
          <input type="text" name="output_name" placeholder="PDFAfterDelete">
        </div>
      </div>
      <button type="submit">Delete Pages</button>
    </form>
  </div>

  <div class="card">
    <h2>üîç Analyse PDF</h2>
    <form action="/analyse_pdf" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <button type="submit">Analyse</button>
    </form>
  </div>
</div>

<<div class="grid" style="margin-top: 40px;">
  <div class="card">
    <h2>üìâ Compress PDF</h2>
    <form action="/compress" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <div class="row">
        <div class="half">
          <label>Compression Quality:</label>
          <select name="quality">
            <option value="low">Low</option>
            <option value="medium" selected>Medium</option>
            <option value="high">High</option>
          </select>
        </div>
        <div class="half">
          <label>Output File Name:</label>
          <input type="text" name="output_name" placeholder="CompressedPDF">
        </div>
      </div>
      <button type="submit">Compress PDF</button>
    </form>
  </div>

  <div class="card">
    <h2>üóúÔ∏è Compress Image</h2>
    <form action="/compress_image" method="post" enctype="multipart/form-data">
      <label>Select Image File:</label>
      <input type="file" name="image_file" accept="image/*" required>
      <div class="row">
        <div class="half">
          <label>Quality (1‚Äì100):</label>
          <input type="number" name="quality" min="1" max="100" value="70">
        </div>
        <div class="half">
          <label>Output File Name:</label>
          <input type="text" name="output_name" placeholder="CompressedImage">
        </div>
      </div>
      <button type="submit">Compress Image</button>
    </form>
  </div>

  <div class="card">
    <h2>üîç OCR PDF</h2>
    <form action="/ocr_pdf" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <div class="row">
        <div class="half">
          <label>Language:</label>
          <input type="text" name="language" placeholder="eng">
        </div>
        <div class="half">
          <label>Output File Name:</label>
          <input type="text" name="output_name" placeholder="OCRText">
        </div>
      </div>
      <button type="submit">Extract Text</button>
    </form>
  </div>

  <div class="card">
    <h2>‚úèÔ∏è Edit PDF</h2>
    <form action="/edit_pdf" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <label>Text to Add:</label>
      <textarea name="edit_text" rows="4" placeholder="Enter text to add..."></textarea>
      <div class="row">
        <div class="half">
          <label>Page Number:</label>
          <input type="number" name="page_number" min="1" placeholder="1">
        </div>
        <div class="half">
          <label>Output File Name:</label>
          <input type="text" name="output_name" placeholder="EditedPDF">
        </div>
      </div>
      <button type="submit">Apply Edit</button>
    </form>
  </div>
</div>

<div class="grid" style="margin-top: 40px;">
  <div class="card">
    <h2>üîÑ Rotate PDF</h2>
    <form action="/rotate_pdf" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>

      <label>Rotation Angle:</label>
      <input type="number" name="rotation_angle" value="90" min="0" max="360">

      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="RotatedPDF">

      <button type="submit">Rotate PDF</button>
    </form>
  </div>

  <div class="card">
    <h2>üîê Lock PDF</h2>
    <form action="/lock_pdf" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <label>Set Password:</label>
      <input type="text" name="password" placeholder="Enter password" required>
      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="LockedPDF">
      <button type="submit">Lock PDF</button>
    </form>
  </div>

  <div class="card">
    <h2>üîì Unlock PDF</h2>
    <form action="/unlock_pdf" method="post" enctype="multipart/form-data">
      <label>Select PDF File (Locked):</label>
      <input type="file" name="pdf_file" required>
      <label>Password:</label>
      <input type="text" name="password" placeholder="Enter password" required>
      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="UnlockedPDF">
      <button type="submit">Unlock PDF</button>
    </form>
  </div>

  <div class="card">
    <h2>üìä PowerPoint ‚û° PDF</h2>
    <form action="/ppt_to_pdf" method="post" enctype="multipart/form-data">
      <label>Select PPT/PPTX File:</label>
      <input type="file" name="ppt_file" accept=".ppt,.pptx" required>

      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="ConvertedPPT">

      <button type="submit">Convert to PDF</button>
    </form>
  </div>
</div>

<div class="grid" style="margin-top: 40px;">
  <div class="card">
    <h2>‚úÇÔ∏è Crop PDF</h2>
    <form action="/crop_pdf" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>
      <label>Crop Area (x1,y1,x2,y2):</label>
      <input type="text" name="crop_values" placeholder="50,50,500,700">
      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="CroppedPDF">
      <button type="submit">Crop PDF</button>
    </form>
  </div>

  <div class="card">
    <h2>üìë Generate PDF from Topic</h2>
    <form action="/generate_notes" method="post" enctype="multipart/form-data">
      <label>Enter Topic/Title:</label>
      <input type="text" name="heading" required placeholder="Enter a topic for PDF generation">

      <label>Output PDF Name:</label>
      <input type="text" name="output_name" placeholder="GeneratedNotesPDF" required>

      <button type="submit">Generate PDF with Notes</button>
    </form>
  </div>

  <div class="card">
    <h2>‚úçÔ∏è Sign PDF</h2>
    <form action="/sign_pdf" method="post" enctype="multipart/form-data">
      <label>Select PDF File:</label>
      <input type="file" name="pdf_file" required>

      <label>Upload Signature Image:</label>
      <input type="file" name="signature_file" accept="image/*" required>

      <label>Signature Position (x,y,width,height):</label>
      <input type="text" name="signature_position" placeholder="100,150,200,80">

      <label>Output File Name:</label>
      <input type="text" name="output_name" placeholder="SignedPDF">

      <button type="submit">Sign PDF</button>
    </form>
</div>

<div class="card">
  <h2>üìë PDF ‚û° PowerPoint</h2>
  <form action="/pdf_to_ppt" method="post" enctype="multipart/form-data">
    <label>Select PDF File:</label>
    <input type="file" name="pdf_file" required>

    <label>Output File Name:</label>
    <input type="text" name="output_name" placeholder="ConvertedPPT">

    <button type="submit">Convert to PowerPoint</button>
  </form>
</div>


</div>

<footer> Made with ‚ù§Ô∏è in Python & Flask </footer>

<script>
  const imageInput = document.getElementById("imageInput");
  const addImageBtn = document.getElementById("addImageBtn");
  const imagePreviewList = document.getElementById("imagePreviewList");
  let allImageFiles = [];

  addImageBtn.addEventListener("click", () => {
    const newInput = document.createElement("input");
    newInput.type = "file";
    newInput.accept = "image/*";
    newInput.multiple = true;
    newInput.click();

    newInput.addEventListener("change", (e) => {
      const newFiles = Array.from(e.target.files);
      allImageFiles.push(...newFiles);
      updatePreview(allImageFiles, imagePreviewList, imageInput);
    });
  });

  imageInput.addEventListener("change", (e) => {
    allImageFiles = Array.from(e.target.files);
    updatePreview(allImageFiles, imagePreviewList, imageInput);
  });

  const mergeInput = document.getElementById("mergeInput");
  const addMergeBtn = document.getElementById("addMergeBtn");
  const mergePreviewList = document.getElementById("mergePreviewList");
  let allMergeFiles = [];

  addMergeBtn.addEventListener("click", () => {
    const newInput = document.createElement("input");
    newInput.type = "file";
    newInput.accept = "application/pdf";
    newInput.multiple = true;
    newInput.click();

    newInput.addEventListener("change", (e) => {
      const newFiles = Array.from(e.target.files);
      allMergeFiles.push(...newFiles);
      updatePreview(allMergeFiles, mergePreviewList, mergeInput);
    });
  });

  mergeInput.addEventListener("change", (e) => {
    allMergeFiles = Array.from(e.target.files);
    updatePreview(allMergeFiles, mergePreviewList, mergeInput);
  });

  function updatePreview(fileList, previewList, inputEl) {
    if (fileList.length === 0) {
      previewList.textContent = "No files added yet";
      return;
    }
    previewList.innerHTML = "";
    fileList.forEach((file, i) => {
      const div = document.createElement("div");
      div.textContent = `${i + 1}. ${file.name}`;
      previewList.appendChild(div);
    });

    const dt = new DataTransfer();
    fileList.forEach(file => dt.items.add(file));
    inputEl.files = dt.files;
  }

</script>
</body>
</html>